# Node.js 项目调试指南

## 调试配置说明

此项目已配置支持通过 Cursor debugger 进行本地调试。

## 可用的调试方式

### 1. 直接启动调试（推荐）
在 Cursor 中按 `F5` 或选择调试配置：
- **调试 Node.js 服务器 (tsx)**: 直接启动调试，单次运行
- **调试 Node.js 服务器 (监听模式)**: 启动调试并监听文件变化，自动重启

### 2. 附加到运行中的服务器
如果服务器已经在调试模式下运行，可以使用：
- **附加到正在运行的服务器**: 附加到端口 9229 上的调试进程

### 3. 命令行调试
你也可以使用以下 npm 脚本：

```bash
# 启动开发服务器（带文件监听）
npm run dev

# 启动调试服务器（带文件监听和调试端口）
npm run dev:debug

# 启动调试服务器（单次运行）
npm run debug
```

## 调试功能

### 已启用的功能：
- ✅ TypeScript 源码映射
- ✅ 断点调试
- ✅ 变量检查
- ✅ 调用堆栈查看
- ✅ 文件变化自动重启
- ✅ ES Modules 支持
- ✅ 路径别名支持 (`@shared/*`)

### 调试端口
- 默认调试端口: `9229`
- 服务器端口: `3001` (配置文件中定义)

## 使用步骤

1. 在代码中设置断点（点击行号左侧）
2. 按 `F5` 启动调试或在调试面板选择配置
3. 服务器启动后访问 `http://localhost:3001`
4. 触发相关接口请求，断点将被激活

## 常见问题

### 如果调试无法启动：
1. 确保 `tsx` 已安装：`npm install`
2. 检查端口 9229 是否被占用
3. 确保当前工作目录在 `apps/node`

### 如果断点不生效：
1. 确保源码映射已启用
2. 检查文件路径是否正确
3. 重启调试会话

## 项目结构
```
apps/node/
├── src/
│   ├── server.ts      # 主入口文件
│   ├── app.ts         # 应用配置
│   ├── routes/        # 路由定义
│   ├── controllers/   # 控制器
│   ├── services/      # 业务逻辑
│   └── middleware/    # 中间件
├── tsconfig.json      # TypeScript 配置
└── package.json       # 项目配置
```